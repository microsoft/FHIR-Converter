{% mergeDiff msg -%}
{
  "contained" : [ {{msg.contained | to_array | batch_render : 'Resource', 'msg'}} ],
  "udiCarrier" : [
    {
      "deviceIdentifier" : "{{msg.udi.deviceIdentifier}}",
      "jurisdiction" : "{{msg.udi.jurisdiction}}",
      "carrierHRF" : "{{msg.udi.carrierHRF}}",
      "carrierAIDC" : "{{msg.udi.carrierAIDC}}",
      "issuer" : "{{msg.udi.issuer}}",
      "entryType" : "{{msg.udi.entryType}}"
    }
  ],
  "deviceName" : [
    {%if msg.udi.name -%}
    {
      "name" : "{{msg.udi.name}}",
      "type" : "udi-label-name"
    },
    {% endif -%}
  ],
  "modelNumber" : "{{msg.model}}",
  "version" : [
    {
      "value" : "{{msg.version}}"
    }
  ],
  "model" : "",
  "udi" : ""
}
{% endmergeDiff -%}